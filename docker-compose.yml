services:
  # 통합 앱 서비스 (Nginx + Backend via supervisor)
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: bistelligence-app
    ports:
      - "80:80"      # Nginx (프론트엔드 + API 프록시)
      - "8000:8000"  # FastAPI 직접 접근 (API 문서 등)
    environment:
      - NODE_ENV=production
      # GCS
      - GCS_BUCKET=bia-ai-storage
      - MDR_MODEL_GCS_PATH=models/mdr_model.pt
    env_file:
      - .env
    restart: unless-stopped

